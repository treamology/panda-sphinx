

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lighting &mdash; Panda3D Manual</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Panda3D Manual" href="../../index.html"/>
        <link rel="up" title="Render Attributes" href="index.html"/>
        <link rel="next" title="Materials" href="materials.html"/>
        <link rel="prev" title="List of All Attributes" href="list-of-all-attributes.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Panda3D
          

          
          </a>

          
            
            
              <div class="version">
                1.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro/index.html">Introduction to Panda3D</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Programming with Panda3D</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../the-scene-graph/index.html">The Scene Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../the-configuration-file/index.html">The Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models-and-actors/index.html">Models and Actors</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Render Attributes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="list-of-all-attributes.html">List of All Attributes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Lighting</a></li>
<li class="toctree-l3"><a class="reference internal" href="materials.html">Materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="depth-test-and-depth-write.html">Depth Test and Depth Write</a></li>
<li class="toctree-l3"><a class="reference internal" href="fog.html">Fog</a></li>
<li class="toctree-l3"><a class="reference internal" href="alpha-testing.html">Alpha Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="color-write-masks.html">Color Write Masks</a></li>
<li class="toctree-l3"><a class="reference internal" href="antialiasing.html">Antialiasing</a></li>
<li class="toctree-l3"><a class="reference internal" href="clip-planes.html">Clip Planes</a></li>
<li class="toctree-l3"><a class="reference internal" href="tinting-and-recoloring.html">Tinting and Recoloring</a></li>
<li class="toctree-l3"><a class="reference internal" href="backface-culling-and-frontface-culling.html">Backface Culling and Frontface Culling</a></li>
<li class="toctree-l3"><a class="reference internal" href="occlusion-culling/index.html">Occlusion Culling</a></li>
<li class="toctree-l3"><a class="reference internal" href="light-ramps.html">Light Ramps</a></li>
<li class="toctree-l3"><a class="reference internal" href="auxiliary-bitplane-control.html">Auxiliary Bitplane Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="stencil-attribute.html">Stencil Test/Write Attribute</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../texturing/index.html">Texturing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shaders/index.html">Shaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../camera-control/index.html">Camera Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/index.html">Sound</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intervals/index.html">Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks-and-event-handling/index.html">Tasks and Event Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../text-and-image-rendering/index.html">Text and Image Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../directgui/index.html">DirectGUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../render-effects/index.html">Render Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../finite-state-machines/index.html">Finite State Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../terrain/index.html">Terrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal-structures/index.html">Advanced operations with Panda3D&#8217;s internal structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../render-to-texture-and-image-postprocessing/index.html">Render-to-Texture and Image Postprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../panda3d-rendering-process/index.html">Panda3D Rendering Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../panda3d-utility-functions.html">Panda3D Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../particle-effects/index.html">Particle Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collision-detection/index.html">Collision Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../garbage-collection/index.html">Garbage Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hardware-support/index.html">Hardware support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math-engine/index.html">Math Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../physics/index.html">Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../motion-paths.html">Motion Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timing/index.html">Timing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multifiles/index.html">Multifiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../showbase.html">ShowBase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file-reading.html">File Reading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../threading.html">Threading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subclassing.html">Subclassing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../table-of-features-supported-per-graphic-renderer.html">Table of features supported per graphic renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pandai/index.html">Artificial Intelligence (PANDAI)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../distribution/index.html">Distributing Panda3D Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples/index.html">Sample Programs in the Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance-tuning/index.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using-c++/index.html">Using C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Panda3D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../building-from-source.html">Building Panda3D from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cheat-sheets.html">Cheat Sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started-on-osx.html">Getting Started on OSX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../more-panda3d-resources.html">More Panda3D Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../thirdparty-licenses.html">Third-party dependencies and license info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../the-irc-channel.html">The IRC Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Panda3D</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Programming with Panda3D</a> &raquo;</li>
      
          <li><a href="index.html">Render Attributes</a> &raquo;</li>
      
    <li>Lighting</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/programming-with-panda3d/render-attributes/lighting.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lighting">
<span id="id1"></span><h1>Lighting<a class="headerlink" href="#lighting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="lighting-basics">
<h2>Lighting Basics<a class="headerlink" href="#lighting-basics" title="Permalink to this headline">¶</a></h2>
<p>In the real world, if you put a light in a room, objects in that room are
illuminated. For example, if you put a table lamp in your living room, that
lamp automatically illuminates your sofa and your chair. In a 3D engine like
Panda3D, lights don&#8217;t illuminate things automatically. Instead, you must tell
the chair and the sofa to <em>be illuminated</em> by the lamp.</p>
<p>So to reiterate, lighting a scene in Panda3D consists of two steps:</p>
<ol class="arabic simple">
<li>Creating lights, and positioning them within the scene.</li>
<li>Telling the other objects to <em>be illuminated</em> by the lights.</li>
</ol>
<p>Panda3D defines four different kinds of light objects: point, directional,
ambient, and spotlight. Each of these is a node that should be attached
somewhere within the scene graph. Like anything you put into the scene, lights
have a position and orientation, which is determined by the basic scene graph
operations like <code class="docutils literal"><span class="pre">setPos()</span></code>,
<code class="docutils literal"><span class="pre">setHpr()</span></code>, etc. The
<code class="docutils literal"><span class="pre">lookAt()</span></code> method is particularly
useful for pointing spotlights and directional lights at a particular
object.</p>
<p>Note that you will need to include the following headers according to the type
of lights you are gonna use:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;ambientLight.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;directionalLight.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;pointLight.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;spotlight.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">The&nbsp;following&nbsp;code&nbsp;inserts&nbsp;a&nbsp;directional&nbsp;light&nbsp;into&nbsp;the&nbsp;scene:</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">dlight</span> <span class="o">=</span> <span class="n">DirectionalLight</span><span class="p">(</span><span class="s1">&#39;my dlight&#39;</span><span class="p">)</span>
<span class="n">dlnp</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">dlight</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">PT</span><span class="p">(</span><span class="n">DirectionalLight</span><span class="p">)</span> <span class="n">d_light</span><span class="p">;</span>
<span class="n">d_light</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DirectionalLight</span><span class="p">(</span><span class="s">&quot;my d_light&quot;</span><span class="p">);</span>
<span class="n">NodePath</span> <span class="n">dlnp</span> <span class="o">=</span> <span class="n">window</span><span class="o">-&gt;</span><span class="n">get_render</span><span class="p">().</span><span class="n">attach_new_node</span><span class="p">(</span><span class="n">d_light</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that, unlike a real, physical light bulb, the light objects are not
themselves directly visible. Although you can&#8217;t see a Panda light itself, you
<em>can</em> see the effect it has on the geometry around it. If you want to make a
light visible, one simple trick is to load a simple model (like a sphere) and
parent it directly to the light itself.</p>
<p>Creating the light and putting it in the scene graph doesn&#8217;t, by itself, have
any visible effect. Your next step is to tell some object to be illuminated by
the light. To do this, use the
<code class="docutils literal"><span class="pre">nodePath.setLight()</span></code> method, which turns on
the light for the indicated NodePath and everything below it in the scene
graph.</p>
<p>In the simplest case, you want all of your lights to illuminate everything
they can, so you turn them on at render, the top of the scene graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">plnp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">window</span><span class="o">-&gt;</span><span class="n">get_render</span><span class="p">().</span><span class="n">set_light</span><span class="p">(</span><span class="n">pnlp</span><span class="p">);</span>
</pre></div>
</div>
<p>You can remove the light setting from render:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">render</span><span class="o">.</span><span class="n">clearLight</span><span class="p">(</span><span class="n">plnp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">window</span><span class="o">-&gt;</span><span class="n">get_render</span><span class="p">().</span><span class="n">clear_light</span><span class="p">(</span><span class="n">pnlp</span><span class="p">);</span>
</pre></div>
</div>
<p>You could also apply the
<code class="docutils literal"><span class="pre">setLight()</span></code> call to a sub-node in
the scene graph, so that a given light only affects a particular object or
group of objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">sofa</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">plnp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">sofa</span><span class="p">.</span><span class="n">set_light</span><span class="p">(</span><span class="n">plnp</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that there are two (or more) different NodePaths involved here: the
NodePath of the light itself, which defines the position and/or orientation of
the light, and the NodePath(s) on which you call
<code class="docutils literal"><span class="pre">setLight()</span></code>, which determines what
subset of the scene graph the light illuminates. There&#8217;s no requirement for
these two NodePaths to be related in any way.</p>
</div>
<div class="section" id="lots-of-lights-performance-implications">
<h2>Lots of Lights: Performance Implications<a class="headerlink" href="#lots-of-lights-performance-implications" title="Permalink to this headline">¶</a></h2>
<p>Each light slows down rendering a little. Using a half-dozen lights to
illuminate an object is no problem at all. However, if you were to use a
hundred lights to illuminate an object, that object would render slowly.</p>
<p>Because of this, when you create a big virtual world, you need to pick and
choose which lights affect which objects. For example, if you had a dungeon
containing a hundred torches, it would not be practical to tell every object
to be illuminated by every torch. Instead, for each object in the dungeon, you
would want to search for the three or four nearest torches, and tell the
object to be illuminated only by those three or four torches.</p>
<p>When per-pixel lighting is enabled, lights are considerably more costly.</p>
</div>
<div class="section" id="colored-lights">
<h2>Colored Lights<a class="headerlink" href="#colored-lights" title="Permalink to this headline">¶</a></h2>
<p>All lights have a color, which is specified by
<code class="docutils literal"><span class="pre">light.setColor((r,</span> <span class="pre">g,</span> <span class="pre">b,</span> <span class="pre">a))</span></code>. The default color is
full white: <code class="docutils literal"><span class="pre">setColor((1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1))</span></code>. The alpha
component is largely irrelevant.</p>
<p>The color of the specular highlight can be controlled using
<code class="docutils literal"><span class="pre">light.setSpecularColor((r,</span> <span class="pre">g,</span> <span class="pre">b,</span> <span class="pre">a))</span></code>. Usually, this is the
same as the light&#8217;s diffuse color.</p>
<p>Note: The R, G, B values can be larger than 1, if you want brighter lights!
However, you can&#8217;t use lighting to make a model brighter than its texture
color.</p>
</div>
<div class="section" id="point-lights">
<h2>Point Lights<a class="headerlink" href="#point-lights" title="Permalink to this headline">¶</a></h2>
<p>Point lights are the easiest kind of light to understand: a point light
simulates a light originating from a single point in space and shining in all
directions, like a very tiny light bulb. A point light&#8217;s position is
important, but its orientation doesn&#8217;t matter.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plight</span> <span class="o">=</span> <span class="n">PointLight</span><span class="p">(</span><span class="s1">&#39;plight&#39;</span><span class="p">)</span>
<span class="n">plight</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">VBase4</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plnp</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">plight</span><span class="p">)</span>
<span class="n">plnp</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">plnp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">PointerTo</span><span class="o">&lt;</span><span class="n">PointLight</span><span class="o">&gt;</span> <span class="n">plightSun</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PointLight</span><span class="p">(</span><span class="s">&quot;sun&quot;</span><span class="p">);</span>
<span class="n">plightSun</span><span class="o">-&gt;</span><span class="n">set_color</span><span class="p">(</span><span class="n">LVecBase4f</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span><span class="mf">.7</span><span class="p">,</span><span class="mf">.7</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="n">NodePath</span> <span class="n">plightSun_p</span> <span class="o">=</span> <span class="n">render</span><span class="p">.</span><span class="n">attach_new_node</span><span class="p">(</span><span class="n">plightSun</span><span class="p">);</span>
<span class="n">plightSun_p</span><span class="p">.</span><span class="n">set_pos</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">);</span>
<span class="n">render</span><span class="p">.</span><span class="n">set_light</span><span class="p">(</span><span class="n">plightSun_p</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="attenuation">
<h2>Attenuation<a class="headerlink" href="#attenuation" title="Permalink to this headline">¶</a></h2>
<p>You can set the attenuation coefficients, which causes the light to drop off
gradually with distance. There are three attenuation coefficients: constant,
linear, and quadratic.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plight</span><span class="o">.</span><span class="n">setAttenuation</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
<p>The default values for these constants are (1, 0, 0), respectively. This means
that the intensity of a light is by default not dependent on the distance to
the light source.</p>
<p>In real-life, lighting conforms to what is known as the inverse-square law.
This means that the light falls off proportional to the inverse of the square
of the distance. To achieve this effect, you need to set the quadratic
coefficient to 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plight</span><span class="o">.</span><span class="n">setAttenuation</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>One disadvantage of this is that the light intensity will approach infinity as
the distance approaches zero. A common way to avoid this in real-time
rendering is to set the constant coefficient to 1.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plight</span><span class="o">.</span><span class="n">setAttenuation</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>This will make the
light intensity smoothly reach 1 as the distance to the light source
approaches zero.</p>
</div>
<div class="section" id="directional-lights">
<h2>Directional Lights<a class="headerlink" href="#directional-lights" title="Permalink to this headline">¶</a></h2>
<p>A directional light is an infinite wave of light, always in the same
direction, like sunlight. A directional light&#8217;s position doesn&#8217;t matter, but
its orientation is important. The default directional light is shining down
the forward (+Y) axis; you can use
<code class="docutils literal"><span class="pre">nodePath.setHpr()</span></code> or
<code class="docutils literal"><span class="pre">nodePath.lookAt()</span></code> to rotate it to face in
a different direction.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">dlight</span> <span class="o">=</span> <span class="n">DirectionalLight</span><span class="p">(</span><span class="s1">&#39;dlight&#39;</span><span class="p">)</span>
<span class="n">dlight</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">VBase4</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">dlnp</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">dlight</span><span class="p">)</span>
<span class="n">dlnp</span><span class="o">.</span><span class="n">setHpr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">dlnp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span>PT(DirectionalLight) d_light;
d_light = new DirectionalLight(&#39;my d_light&#39;);
d_light-&gt;set_color(LVecBase4f(0.8, 0.8, 0.5, 1));
NodePath dlnp = window-&gt;get_render().attach_new_node(d_light);
dlnp.set_hpr(-30, -60, 0);
window-&gt;get_render().set_light(dlnp);
</pre></div>
</div>
</div>
<div class="section" id="ambient-lights">
<h2>Ambient Lights<a class="headerlink" href="#ambient-lights" title="Permalink to this headline">¶</a></h2>
<p>An ambient light is used to fill in the shadows on the dark side of an object,
so it doesn&#8217;t look completely black. The light from an ambient light is
uniformly distributed everywhere in the world, so the ambient light&#8217;s position
and orientation are irrelevant.</p>
<p>Usually you don&#8217;t want to create an ambient light without also creating one of
the other kinds of lights, since an object illuminated solely by ambient light
will be completely flat shaded and you won&#8217;t be able to see any of its
details. Typically, ambient lights are given a fairly dark gray color, so they
don&#8217;t overpower the other lights in the scene.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">alight</span> <span class="o">=</span> <span class="n">AmbientLight</span><span class="p">(</span><span class="s1">&#39;alight&#39;</span><span class="p">)</span>
<span class="n">alight</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">VBase4</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">alnp</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">alight</span><span class="p">)</span>
<span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">alnp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="spotlights">
<h2>Spotlights<a class="headerlink" href="#spotlights" title="Permalink to this headline">¶</a></h2>
<p>Spotlights represent the most sophisticated kind of light. A spotlight has
both a point and a direction, and a field-of-view. In fact, a spotlight
contains a lens, just like a camera does; the lens should be a PerspectiveLens
and is used to define the area of effect of the light (the light illuminates
everything within the field of view of the lens).</p>
<p>Note that the English word &#8220;spotlight&#8221; is one word, as opposed to the other
kinds of lights, which are two words. Thus, the class name is correctly
spelled &#8220;Spotlight&#8221;, not &#8220;SpotLight&#8221;.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">slight</span> <span class="o">=</span> <span class="n">Spotlight</span><span class="p">(</span><span class="s1">&#39;slight&#39;</span><span class="p">)</span>
<span class="n">slight</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">VBase4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lens</span> <span class="o">=</span> <span class="n">PerspectiveLens</span><span class="p">()</span>
<span class="n">slight</span><span class="o">.</span><span class="n">setLens</span><span class="p">(</span><span class="n">lens</span><span class="p">)</span>
<span class="n">slnp</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">slight</span><span class="p">)</span>
<span class="n">slnp</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">slnp</span><span class="o">.</span><span class="n">lookAt</span><span class="p">(</span><span class="n">myObject</span><span class="p">)</span>
<span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">slnp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="putting-it-all-together">
<h2>Putting it all Together<a class="headerlink" href="#putting-it-all-together" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of lighting. There are an ambient light and two directional
lights lighting the scene, and a green ambient light that only affects one of
the pandas.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">direct.directbase.DirectStart</span>
<span class="kn">from</span> <span class="nn">panda3d.core</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Put two pandas in the scene, panda x and panda y.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="s1">&#39;panda&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">reparentTo</span><span class="p">(</span><span class="n">render</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="s1">&#39;panda&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">reparentTo</span><span class="p">(</span><span class="n">render</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Position the camera to view the two pandas.</span>
<span class="n">base</span><span class="o">.</span><span class="n">trackball</span><span class="o">.</span><span class="n">node</span><span class="p">()</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Now create some lights to apply to everything in the scene.</span>

<span class="c1"># Create Ambient Light</span>
<span class="n">ambientLight</span> <span class="o">=</span> <span class="n">AmbientLight</span><span class="p">(</span><span class="s1">&#39;ambientLight&#39;</span><span class="p">)</span>
<span class="n">ambientLight</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Vec4</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ambientLightNP</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">ambientLight</span><span class="p">)</span>
<span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">ambientLightNP</span><span class="p">)</span>

<span class="c1"># Directional light 01</span>
<span class="n">directionalLight</span> <span class="o">=</span> <span class="n">DirectionalLight</span><span class="p">(</span><span class="s1">&#39;directionalLight&#39;</span><span class="p">)</span>
<span class="n">directionalLight</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Vec4</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">directionalLightNP</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">directionalLight</span><span class="p">)</span>
<span class="c1"># This light is facing backwards, towards the camera.</span>
<span class="n">directionalLightNP</span><span class="o">.</span><span class="n">setHpr</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">directionalLightNP</span><span class="p">)</span>

<span class="c1"># Directional light 02</span>
<span class="n">directionalLight</span> <span class="o">=</span> <span class="n">DirectionalLight</span><span class="p">(</span><span class="s1">&#39;directionalLight&#39;</span><span class="p">)</span>
<span class="n">directionalLight</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Vec4</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">directionalLightNP</span> <span class="o">=</span> <span class="n">render</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">directionalLight</span><span class="p">)</span>
<span class="c1"># This light is facing forwards, away from the camera.</span>
<span class="n">directionalLightNP</span><span class="o">.</span><span class="n">setHpr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">render</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">directionalLightNP</span><span class="p">)</span>

<span class="c1"># Now attach a green light only to object x.</span>
<span class="n">ambient</span> <span class="o">=</span> <span class="n">AmbientLight</span><span class="p">(</span><span class="s1">&#39;ambient&#39;</span><span class="p">)</span>
<span class="n">ambient</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">Vec4</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ambientNP</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">attachNewNode</span><span class="p">(</span><span class="n">ambient</span><span class="p">)</span>

<span class="c1"># If we did not call setLightOff() first, the green light would add to</span>
<span class="c1"># the total set of lights on this object. Since we do call</span>
<span class="c1"># setLightOff(), we are turning off all the other lights on this</span>
<span class="c1"># object first, and then turning on only the green light.</span>
<span class="n">x</span><span class="o">.</span><span class="n">setLightOff</span><span class="p">()</span>
<span class="n">x</span><span class="o">.</span><span class="n">setLight</span><span class="p">(</span><span class="n">ambientNP</span><span class="p">)</span>

<span class="c1">#run the example</span>
<span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="shadow-mapping">
<h2>Shadow Mapping<a class="headerlink" href="#shadow-mapping" title="Permalink to this headline">¶</a></h2>
<p>As for version 1.7.0, Panda3D offers fully automatic shadow mapping support
for spotlights and directional lights. You can enable shadows by calling
<code class="docutils literal"><span class="pre">setShadowCaster()</span></code>. The nodes that receive
shadows will need to have :ref:` &lt;the-shader-generator&gt;` enabled, otherwise no
shadows will appear.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Use a 512x512 resolution shadow map</span>
<span class="n">light</span><span class="o">.</span><span class="n">setShadowCaster</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="c1"># Enable the shader generator for the receiving nodes</span>
<span class="n">render</span><span class="o">.</span><span class="n">setShaderAuto</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// Use a 512x512 resolution shadow map</span>
<span class="n">light</span><span class="o">-&gt;</span><span class="n">set_shadow_caster</span><span class="p">(</span><span class="nb">true</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">);</span>
<span class="c1">// Enable the shader generator for the receiving nodes</span>
<span class="n">window</span><span class="o">-&gt;</span><span class="n">get_render</span><span class="p">().</span><span class="n">set_shader_auto</span><span class="p">();</span>
</pre></div>
</div>
<p>Note that, even though in general shadowing is easy to set-up, you will want
to tweak the light&#8217;s lens settings to get the best depth buffer precision. Use
the <code class="docutils literal"><span class="pre">setNearFar()</span></code> method on the Lens
to get a perfect fit of what is being rendered. Also, for directional lights,
you will need to call <code class="docutils literal"><span class="pre">setFilmSize()</span></code>
on the Lens and position the light properly so that the light camera will get
an optimal view of the scene.</p>
<p>Also note that every Light is in fact also a Camera, so you can easily exclude
objects from being shadowed (e.g. for performance reasons) by use of camera
masks.</p>
<p>If you have very thin objects, you may run into self-shadowing issues if the
backside of the object casts shadows on its frontside. You can easily fix this
by applying a depth offset to the object in question. A depth offset of 1
means to use an offset as small as possible, but big enough to make a
difference. This should generally be enough. You can call
<code class="docutils literal"><span class="pre">setDepthOffset()</span></code> on the NodePath or use
the <code class="docutils literal"><span class="pre">depth-offset</span></code> scalar in the .egg
file.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">leaves</span><span class="o">.</span><span class="n">setDepthOffset</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">leaves</span><span class="p">.</span><span class="n">set_depth_offset</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="materials.html" class="btn btn-neutral float-right" title="Materials" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="list-of-all-attributes.html" class="btn btn-neutral" title="List of All Attributes" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Panda3D.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.10.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>